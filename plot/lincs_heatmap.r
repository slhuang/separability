#!/usr/bin/env Rscript

name = "BRD-K81418486.txt" #"BRD-K85133207.txt (EXP1)" 	 	#BRD-K85133207.txt \n 			 	 		
fx = "202125_s_at"	#"201719_s_at"				
fy ="202417_at" #"202720_at"    


px <- c(20.230740,9.662562)
 # # the first line in "meta.txt" 
py <- c (1,11.236356) #  # the second line in "meta.txt"
estimate <- read.csv("ratioHist.txt",sep="\t",header = TRUE,check.names=FALSE)
rnames <- estimate[,1]
est_matrix <- data.matrix(estimate[,2:ncol(estimate)])
rownames(est_matrix) <- rnames
my_palette <- colorRampPalette(c("red", "white", "blue"), space="rgb")(n=300) 
my_break <- c(seq(-220, 0, length.out=300/2)-0.5, 0, seq(0, 220, length.out=300/2)+0.5) #300 100
png("../fig/ratioHist_LINCS_1.pdf", width=4, height=4, units="in", res=220,pointsize = 12)
est_heatmap <- heatmap(est_matrix, Rowv = NA, Colv=NA, col = my_palette, breaks=my_break,  xlab = fx, ylab =fy,  main = name, scale ="none", margins=c(4.2,4.5),add.expr =points(px,py,col=c("darkblue","darkred")))
#abline(v=0,col="red")
#abline(h=0,col="red")
#points(px,py)
#abline(a=1.856648,b=-1.122625,col="red")  	 
#title(xlab=fx
# ,mgp=c(-2,-1,-5))
dev.off()


#lincs

# 	-1.78	-1.59	-1.39	-1.20	-1.01	-0.81	-0.62	-0.42	-0.23	-0.04	0.16	0.35	0.54	0.74	0.93	1.13	1.32	1.51	1.71	1.90
# -2.02	-24	-14	13	-8	-8	-17	27	11	27	-15	24	20	32	38	29	26	36	34	36	209
# -1.83	-15	-8	-9	-10	-10	-10	-10	-10	-9	11	-8	12	-6	-6	13	-5	-4	15	-4	19
# -1.65	-17	-9	10	-12	-11	8	8	9	-11	-11	10	18	11	-7	13	-5	-5	-4	-4	23
# -1.46	-17	-9	-12	7	-13	-4	-3	-14	6	-12	22	9	11	11	11	-6	13	-4	14	23
# -1.27	-18	-11	-13	-13	-15	-17	-7	-10	13	-15	20	-13	9	-10	-8	12	-7	-5	-5	18
# -1.08	-20	-13	-13	-15	-17	17	-12	-19	-18	26	-6	14	-14	-12	-10	-9	-7	-6	-6	26
# -0.89	-20	-12	-14	-16	-19	-21	-6	-15	-21	4	-18	-8	13	-15	-12	-10	12	-6	-6	26
# -0.70	-20	-12	-3	-17	-13	-21	-18	-18	-18	12	-20	21	-10	-7	15	-11	-9	-8	13	6
# -0.52	-19	-11	-14	-9	-5	-16	-19	-19	-24	-19	-23	-15	-13	-17	-3	7	18	-9	-7	-14
# -0.33	-18	-12	-15	-17	-20	-18	-15	-20	-16	-15	-19	-10	-15	-18	-16	4	-11	-9	-8	-6
# -0.14	-19	9	-16	-18	-21	-13	-26	-26	-23	-23	-7	-14	-17	6	-17	-14	17	9	11	-16
# 0.05	-9	-11	-13	-15	-18	-16	-23	-21	-26	-17	-4	-24	-19	3	-18	-3	-12	9	-9	-16
# 0.24	-17	-11	-12	-14	10	-14	-22	-19	-4	-21	-20	-24	-23	-15	-19	-15	-13	-10	-10	-10
# 0.43	-15	-10	-11	-13	-15	-19	-14	-9	-23	9	-24	-9	-22	-20	-11	-15	16	9	11	-17
# 0.61	-14	-9	-10	-13	-14	-9	-18	-15	-21	-22	-22	-7	-21	-20	-17	-14	6	-11	-9	-11
# 0.80	-11	-7	-9	-10	-13	-8	-16	-12	-19	-21	-13	-20	-14	-19	-17	-15	-11	-11	10	10
# 0.99	-12	-6	-8	-9	-11	-13	4	-15	-16	-17	-8	-17	-8	-8	-15	3	-11	-10	-9	-16
# 1.18	-9	-6	-7	-8	-9	-11	-12	-12	-14	-16	-4	-3	-16	-15	-14	-12	-11	-10	-8	-16
# 1.37	-10	-6	-6	-7	-8	-10	9	-11	-12	-12	-13	-12	-13	-12	-12	-10	-9	-10	-8	-6
# 1.56	-20	-9	-10	-12	-14	-15	-17	-17	-18	-20	-19	-20	-21	-20	-19	-19	-17	-16	-15	-32
